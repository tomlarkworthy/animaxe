/// <reference path="../node_modules/rx/ts/rx.all.d.ts" />
/// <reference path="../types/node.d.ts" />
/// <reference path="../types/should.d.ts" />
require('source-map-support').install();
var Ax = require("../src/animaxe");
var Rx = require("rx");
//create an animator, at 30FPS
try {
    var canvas = document.getElementById("canvas");
    console.log("browser", canvas);
}
catch (err) {
    console.log(err);
    var Canvas = require('canvas');
    var canvas = new Canvas(100, 100);
    console.log("node", canvas);
}
console.log("context", context);
var context = canvas.getContext('2d');
var animator = new Ax.Animator(context); /*should be based on context*/
function thickLine1tick(thickness, start, end, css_color) {
    //console.log("thickLine1tick: ", thickness, start, end, css_color);
    var css = Ax.toStreamColor(css_color);
    return Ax.take(1, Ax.draw(function (tick) {
        tick.ctx.strokeStyle = css.next();
        tick.ctx.beginPath();
        var startVal = start.next();
        var endVal = end.next();
        var ctx = tick.ctx;
        ctx.lineWidth = thickness;
        console.log("thickLine1tick: drawing between ", startVal, endVal);
        ctx.moveTo(startVal[0], startVal[1]);
        ctx.lineTo(endVal[0], endVal[1]);
        ctx.closePath();
        ctx.stroke();
    }, null, [start, end]));
}
function sparkLine(start, end, css_color) {
    /*
    return thickLine1tick(6,
            start,
            end, css_color)
        .then(thickLine1tick(2,
            Ax.previous(start), // todo, this method does not get called every round
            Ax.previous(end),
            css_color))
        .then(thickLine1tick(1,
            Ax.previous(Ax.previous(start)),
            Ax.previous(Ax.previous(end)),
            css_color));
    */
    /*
    return thickLine1tick(6,
            start,
            end, css_color)
        .then(thickLine1tick(2,
            start,
            end, css_color))
        .then(thickLine1tick(1,
            start,
            end, css_color));
    */
    return thickLine1tick(6, start, end, css_color);
}
//large circle funcitons
var bigSin = Ax.sin(1).map(function (x) { return x * 40 + 50; });
var bigCos = Ax.cos(1).map(function (x) { return x * 40 + 50; });
var red = Ax.sin(2).map(function (x) { return x * 125 + 125; });
var green = Ax.sin(2).map(function (x) { return x * 55 + 200; });
//animator.play(Ax.changeColor("#000000", Ax.rect([0,0],[100,100]))); //draw black background
animator.play(Ax.loop(sparkLine(Ax.point(Ax.previous(Ax.sin(1).map(function (x) { return x * 40 + 50; })), Ax.previous(Ax.cos(1).map(function (x) { return x * 40 + 50; }))), Ax.point(bigSin, bigCos), Ax.color(red, green, 0, 0.5))));
try {
    //browser
    var time;
    var render = function () {
        window.requestAnimationFrame(render);
        var now = new Date().getTime(), dt = now - (time || now);
        time = now;
        animator.root.onNext(new Ax.DrawTick(animator.ctx, dt / 1000));
    };
    render();
}
catch (err) {
    //node.js
    animator.play(Ax.save(100, 100, "images/tutorial2.gif"));
    animator.ticker(Rx.Observable.return(0.1).repeat(4));
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4YW1wbGUyLnRzIl0sIm5hbWVzIjpbInRoaWNrTGluZTF0aWNrIiwic3BhcmtMaW5lIl0sIm1hcHBpbmdzIjoiQUFBQSxBQUdBLDBEQUgwRDtBQUMxRCwyQ0FBMkM7QUFDM0MsNkNBQTZDO0FBQzdDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBQ3hDLElBQU8sRUFBRSxXQUFXLGdCQUFnQixDQUFDLENBQUM7QUFDdEMsSUFBTyxFQUFFLFdBQVcsSUFBSSxDQUFDLENBQUM7QUFFMUIsQUFDQSw4QkFEOEI7SUFDMUIsQ0FBQztJQUNELElBQUksTUFBTSxHQUFPLFFBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDbkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDbkMsQ0FBRTtBQUFBLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDWCxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2pCLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMvQixJQUFJLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDbEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDaEMsQ0FBQztBQUVELE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ2hDLElBQUksT0FBTyxHQUE2QixNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBRWhFLElBQUksUUFBUSxHQUFnQixJQUFJLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEVBQUUsOEJBQUQsQUFBK0I7QUFHcEYsd0JBQ0ksU0FBaUIsRUFDakIsS0FBcUIsRUFDckIsR0FBbUIsRUFDbkIsU0FBa0M7SUFFbENBLG9FQUFvRUE7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ZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9ub2RlX21vZHVsZXMvcngvdHMvcnguYWxsLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGVzL25vZGUuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwZXMvc2hvdWxkLmQudHNcIiAvPlxucmVxdWlyZSgnc291cmNlLW1hcC1zdXBwb3J0JykuaW5zdGFsbCgpO1xuaW1wb3J0IEF4ID0gcmVxdWlyZShcIi4uL3NyYy9hbmltYXhlXCIpO1xuaW1wb3J0IFJ4ID0gcmVxdWlyZShcInJ4XCIpO1xuXG4vL2NyZWF0ZSBhbiBhbmltYXRvciwgYXQgMzBGUFNcbnRyeSB7XG4gICAgdmFyIGNhbnZhczphbnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhc1wiKTtcbiAgICBjb25zb2xlLmxvZyhcImJyb3dzZXJcIiwgY2FudmFzKTtcbn0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgdmFyIENhbnZhcyA9IHJlcXVpcmUoJ2NhbnZhcycpO1xuICAgIHZhciBjYW52YXMgPSBuZXcgQ2FudmFzKDEwMCwgMTAwKTtcbiAgICBjb25zb2xlLmxvZyhcIm5vZGVcIiwgY2FudmFzKTtcbn1cblxuY29uc29sZS5sb2coXCJjb250ZXh0XCIsIGNvbnRleHQpO1xudmFyIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG52YXIgYW5pbWF0b3I6IEF4LkFuaW1hdG9yID0gbmV3IEF4LkFuaW1hdG9yKGNvbnRleHQpOyAvKnNob3VsZCBiZSBiYXNlZCBvbiBjb250ZXh0Ki9cblxuXG5mdW5jdGlvbiB0aGlja0xpbmUxdGljayhcbiAgICB0aGlja25lc3M6IG51bWJlcixcbiAgICBzdGFydDogQXguUG9pbnRTdHJlYW0sXG4gICAgZW5kOiBBeC5Qb2ludFN0cmVhbSxcbiAgICBjc3NfY29sb3I6IHN0cmluZyB8IEF4LkNvbG9yU3RyZWFtKVxuOiBBeC5BbmltYXRpb24ge1xuICAgIC8vY29uc29sZS5sb2coXCJ0aGlja0xpbmUxdGljazogXCIsIHRoaWNrbmVzcywgc3RhcnQsIGVuZCwgY3NzX2NvbG9yKTtcblxuICAgIHZhciBjc3MgPSBBeC50b1N0cmVhbUNvbG9yKGNzc19jb2xvcik7XG4gICAgcmV0dXJuIEF4LnRha2UoMSwgQXguZHJhdyhmdW5jdGlvbih0aWNrOiBBeC5EcmF3VGljaykge1xuICAgICAgICB0aWNrLmN0eC5zdHJva2VTdHlsZSA9IGNzcy5uZXh0KCk7XG4gICAgICAgIHRpY2suY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICB2YXIgc3RhcnRWYWwgPSBzdGFydC5uZXh0KCk7XG4gICAgICAgIHZhciBlbmRWYWwgPSBlbmQubmV4dCgpO1xuICAgICAgICB2YXIgY3R4ID0gdGljay5jdHg7XG4gICAgICAgIGN0eC5saW5lV2lkdGggPSB0aGlja25lc3M7XG4gICAgICAgIGNvbnNvbGUubG9nKFwidGhpY2tMaW5lMXRpY2s6IGRyYXdpbmcgYmV0d2VlbiBcIiwgc3RhcnRWYWwsIGVuZFZhbCk7XG4gICAgICAgIGN0eC5tb3ZlVG8oc3RhcnRWYWxbMF0sIHN0YXJ0VmFsWzFdKTtcbiAgICAgICAgY3R4LmxpbmVUbyhlbmRWYWxbMF0sIGVuZFZhbFsxXSk7XG4gICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgIH0sIG51bGwsIFtzdGFydCwgZW5kXSkpO1xufVxuXG5mdW5jdGlvbiBzcGFya0xpbmUoc3RhcnQ6IEF4LlBvaW50U3RyZWFtLCBlbmQ6IEF4LlBvaW50U3RyZWFtLCBjc3NfY29sb3I6IHN0cmluZyB8IEF4LkNvbG9yU3RyZWFtKTogQXguQW5pbWF0aW9uIHsgLy93ZSBjb3VsZCBiZSBjbGV2ZXIgYW5kIGxldCBzcGFyayB0YWtlIGEgc2VxLCBidXQgdXNlciBmdW5jdGlvbnMgc2hvdWxkIGJlIHNpbXBsZVxuICAgIC8qXG4gICAgcmV0dXJuIHRoaWNrTGluZTF0aWNrKDYsXG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCwgY3NzX2NvbG9yKVxuICAgICAgICAudGhlbih0aGlja0xpbmUxdGljaygyLFxuICAgICAgICAgICAgQXgucHJldmlvdXMoc3RhcnQpLCAvLyB0b2RvLCB0aGlzIG1ldGhvZCBkb2VzIG5vdCBnZXQgY2FsbGVkIGV2ZXJ5IHJvdW5kXG4gICAgICAgICAgICBBeC5wcmV2aW91cyhlbmQpLFxuICAgICAgICAgICAgY3NzX2NvbG9yKSlcbiAgICAgICAgLnRoZW4odGhpY2tMaW5lMXRpY2soMSxcbiAgICAgICAgICAgIEF4LnByZXZpb3VzKEF4LnByZXZpb3VzKHN0YXJ0KSksXG4gICAgICAgICAgICBBeC5wcmV2aW91cyhBeC5wcmV2aW91cyhlbmQpKSxcbiAgICAgICAgICAgIGNzc19jb2xvcikpO1xuICAgICovXG4gICAgLypcbiAgICByZXR1cm4gdGhpY2tMaW5lMXRpY2soNixcbiAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgZW5kLCBjc3NfY29sb3IpXG4gICAgICAgIC50aGVuKHRoaWNrTGluZTF0aWNrKDIsXG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCwgY3NzX2NvbG9yKSlcbiAgICAgICAgLnRoZW4odGhpY2tMaW5lMXRpY2soMSxcbiAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgZW5kLCBjc3NfY29sb3IpKTtcbiAgICAqL1xuXG4gICAgcmV0dXJuIHRoaWNrTGluZTF0aWNrKDYsXG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCwgY3NzX2NvbG9yKTtcbn1cblxuLy9sYXJnZSBjaXJjbGUgZnVuY2l0b25zXG52YXIgYmlnU2luID0gQXguc2luKDEpLm1hcCh4ID0+IHggKiA0MCArIDUwKTtcbnZhciBiaWdDb3MgPSBBeC5jb3MoMSkubWFwKHggPT4geCAqIDQwICsgNTApO1xuXG52YXIgcmVkICAgPSBBeC5zaW4oMikubWFwKHggPT4geCAqIDEyNSArIDEyNSk7XG52YXIgZ3JlZW4gPSBBeC5zaW4oMikubWFwKHggPT4geCAqIDU1ICsgMjAwKTtcblxuXG4vL2FuaW1hdG9yLnBsYXkoQXguY2hhbmdlQ29sb3IoXCIjMDAwMDAwXCIsIEF4LnJlY3QoWzAsMF0sWzEwMCwxMDBdKSkpOyAvL2RyYXcgYmxhY2sgYmFja2dyb3VuZFxuYW5pbWF0b3IucGxheShcbiAgICAgICAgQXgubG9vcChcbiAgICAgICAgICAgIHNwYXJrTGluZShcbiAgICAgICAgICAgICAgICBBeC5wb2ludChcbiAgICAgICAgICAgICAgICAgICAgQXgucHJldmlvdXMoQXguc2luKDEpLm1hcCh4ID0+IHggKiA0MCArIDUwKSksXG4gICAgICAgICAgICAgICAgICAgIEF4LnByZXZpb3VzKEF4LmNvcygxKS5tYXAoeCA9PiB4ICogNDAgKyA1MCkpXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBBeC5wb2ludChcbiAgICAgICAgICAgICAgICAgICAgYmlnU2luLFxuICAgICAgICAgICAgICAgICAgICBiaWdDb3MpLFxuICAgICAgICAgICAgICAgIEF4LmNvbG9yKHJlZCxncmVlbiwwLDAuNSlcbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICk7XG5cbnRyeSB7XG4gICAgLy9icm93c2VyXG4gICAgdmFyIHRpbWU7XG4gICAgdmFyIHJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlbmRlcik7XG4gICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcbiAgICAgICAgICAgIGR0ID0gbm93IC0gKHRpbWUgfHwgbm93KTtcbiAgICAgICAgdGltZSA9IG5vdztcbiAgICAgICAgYW5pbWF0b3Iucm9vdC5vbk5leHQobmV3IEF4LkRyYXdUaWNrKGFuaW1hdG9yLmN0eCwgZHQvMTAwMCkpO1xuICAgIH07XG4gICAgcmVuZGVyKCk7XG59IGNhdGNoKGVycikge1xuICAgIC8vbm9kZS5qc1xuICAgIGFuaW1hdG9yLnBsYXkoQXguc2F2ZSgxMDAsIDEwMCwgXCJpbWFnZXMvdHV0b3JpYWwyLmdpZlwiKSk7XG4gICAgYW5pbWF0b3IudGlja2VyKFJ4Lk9ic2VydmFibGUucmV0dXJuKDAuMSkucmVwZWF0KDQpKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==