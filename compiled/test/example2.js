/// <reference path="../node_modules/rx/ts/rx.all.d.ts" />
/// <reference path="../types/node.d.ts" />
/// <reference path="../types/should.d.ts" />
require('source-map-support').install();
var Ax = require("../src/animaxe");
var Rx = require("rx");
var helper = require("./helper");
var animator = helper.getExampleAnimator();
//a line between two points of a specified thickness and color (which are temporally varying parameters)
function thickLine1tick(thickness, start, end, css_color) {
    //console.log("thickLine1tick: ", thickness, start, end, css_color);
    var css = Ax.toStreamColor(css_color);
    return Ax.take(1, Ax.draw(function (tick) {
        tick.ctx.strokeStyle = css.next(tick.clock);
        tick.ctx.beginPath();
        var startVal = start.next(tick.clock);
        var endVal = end.next(tick.clock);
        var ctx = tick.ctx;
        ctx.lineWidth = thickness;
        //console.log("thickLine1tick: drawing between ", tick.clock, startVal, endVal);
        ctx.moveTo(startVal[0], startVal[1]);
        ctx.lineTo(endVal[0], endVal[1]);
        ctx.closePath();
        ctx.stroke();
    }));
}
/**
 * Three frame animation of a thinning line. Animations are displaced in time so even if the start and end streams move
 * The line doesn't
 */
function sparkLine(start, end, css_color) {
    return thickLine1tick(6, start, end, css_color)
        .then(thickLine1tick(2, Ax.displaceT(-0.1, start), Ax.displaceT(-0.1, end), css_color))
        .then(thickLine1tick(1, Ax.displaceT(-0.2, start), Ax.displaceT(-0.2, end), css_color));
}
//large circle funcitons
var bigSin = Ax.sin(1).map(function (x) { return x * 40 + 50; });
var bigCos = Ax.cos(1).map(function (x) { return x * 40 + 50; });
//periodic color
var red = 255;
var green = Ax.sin(2).map(function (x) { return x * 100 + 55; });
var blue = 50;
animator.play(Ax.changeColor("#000000", Ax.rect([0, 0], [100, 100]))); //draw black background
animator.play(Ax.emit(sparkLine(Ax.point(bigSin, bigCos), Ax.displaceT(-0.1, Ax.point(bigSin, bigCos)), Ax.color(red, green, blue, 0.5))));
try {
    //browser
    var time;
    var render = function () {
        window.requestAnimationFrame(render);
        var now = new Date().getTime(), dt = now - (time || now);
        time = now;
        animator.root.onNext(new Ax.DrawTick(animator.ctx, 0, dt / 1000));
    };
    render();
}
catch (err) {
    //node.js
    animator.play(Ax.save(100, 100, "images/tutorial2.gif"));
    animator.ticker(Rx.Observable.return(0.1).repeat(20));
}
helper.playExample("example2", 20, animator);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4YW1wbGUyLnRzIl0sIm5hbWVzIjpbInRoaWNrTGluZTF0aWNrIiwic3BhcmtMaW5lIl0sIm1hcHBpbmdzIjoiQUFBQSxBQUdBLDBEQUgwRDtBQUMxRCwyQ0FBMkM7QUFDM0MsNkNBQTZDO0FBQzdDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBQ3hDLElBQU8sRUFBRSxXQUFXLGdCQUFnQixDQUFDLENBQUM7QUFDdEMsSUFBTyxFQUFFLFdBQVcsSUFBSSxDQUFDLENBQUM7QUFDMUIsSUFBTyxNQUFNLFdBQVcsVUFBVSxDQUFDLENBQUM7QUFHcEMsSUFBSSxRQUFRLEdBQWdCLE1BQU0sQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0FBRXhELEFBQ0Esd0dBRHdHO3dCQUVwRyxTQUFpQixFQUNqQixLQUFxQixFQUNyQixHQUFtQixFQUNuQixTQUFrQztJQUVsQ0EsQUFDQUEsb0VBRG9FQTtRQUNoRUEsR0FBR0EsR0FBR0EsRUFBRUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsQ0FBQ0E7SUFDdENBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLFVBQVNBLElBQWlCQTtRQUNoRCxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1QyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3JCLElBQUksUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3RDLElBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2xDLElBQUksR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7UUFDbkIsR0FBRyxDQUFDLFNBQVMsR0FB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QixDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JDLElBQUksR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEVBQzFCLEVBQUUsR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLElBQUksR0FBRyxDQUFDLENBQUM7UUFDN0IsSUFBSSxHQUFHLEdBQUcsQ0FBQztRQUNYLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLEdBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUNwRSxDQUFDLENBQUM7SUFDRixNQUFNLEVBQUUsQ0FBQztBQUNiLENBQUU7QUFBQSxLQUFLLENBQUEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ1YsQUFDQSxTQURTO0lBQ1QsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsc0JBQXNCLENBQUMsQ0FBQyxDQUFDO0lBQ3pELFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDMUQsQ0FBQztBQUVELE1BQU0sQ0FBQyxXQUFXLENBQUMsVUFBVSxFQUFFLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyIsImZpbGUiOiJleGFtcGxlMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9ub2RlX21vZHVsZXMvcngvdHMvcnguYWxsLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGVzL25vZGUuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwZXMvc2hvdWxkLmQudHNcIiAvPlxucmVxdWlyZSgnc291cmNlLW1hcC1zdXBwb3J0JykuaW5zdGFsbCgpO1xuaW1wb3J0IEF4ID0gcmVxdWlyZShcIi4uL3NyYy9hbmltYXhlXCIpO1xuaW1wb3J0IFJ4ID0gcmVxdWlyZShcInJ4XCIpO1xuaW1wb3J0IGhlbHBlciA9IHJlcXVpcmUoXCIuL2hlbHBlclwiKTtcblxuXG52YXIgYW5pbWF0b3I6IEF4LkFuaW1hdG9yID0gaGVscGVyLmdldEV4YW1wbGVBbmltYXRvcigpO1xuXG4vL2EgbGluZSBiZXR3ZWVuIHR3byBwb2ludHMgb2YgYSBzcGVjaWZpZWQgdGhpY2tuZXNzIGFuZCBjb2xvciAod2hpY2ggYXJlIHRlbXBvcmFsbHkgdmFyeWluZyBwYXJhbWV0ZXJzKVxuZnVuY3Rpb24gdGhpY2tMaW5lMXRpY2soXG4gICAgdGhpY2tuZXNzOiBudW1iZXIsXG4gICAgc3RhcnQ6IEF4LlBvaW50U3RyZWFtLFxuICAgIGVuZDogQXguUG9pbnRTdHJlYW0sXG4gICAgY3NzX2NvbG9yOiBzdHJpbmcgfCBBeC5Db2xvclN0cmVhbSlcbjogQXguQW5pbWF0aW9uIHtcbiAgICAvL2NvbnNvbGUubG9nKFwidGhpY2tMaW5lMXRpY2s6IFwiLCB0aGlja25lc3MsIHN0YXJ0LCBlbmQsIGNzc19jb2xvcik7XG4gICAgdmFyIGNzcyA9IEF4LnRvU3RyZWFtQ29sb3IoY3NzX2NvbG9yKTtcbiAgICByZXR1cm4gQXgudGFrZSgxLCBBeC5kcmF3KGZ1bmN0aW9uKHRpY2s6IEF4LkRyYXdUaWNrKSB7XG4gICAgICAgIHRpY2suY3R4LnN0cm9rZVN0eWxlID0gY3NzLm5leHQodGljay5jbG9jayk7XG4gICAgICAgIHRpY2suY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICB2YXIgc3RhcnRWYWwgPSBzdGFydC5uZXh0KHRpY2suY2xvY2spO1xuICAgICAgICB2YXIgZW5kVmFsID0gZW5kLm5leHQodGljay5jbG9jayk7XG4gICAgICAgIHZhciBjdHggPSB0aWNrLmN0eDtcbiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IHRoaWNrbmVzcztcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInRoaWNrTGluZTF0aWNrOiBkcmF3aW5nIGJldHdlZW4gXCIsIHRpY2suY2xvY2ssIHN0YXJ0VmFsLCBlbmRWYWwpO1xuICAgICAgICBjdHgubW92ZVRvKHN0YXJ0VmFsWzBdLCBzdGFydFZhbFsxXSk7XG4gICAgICAgIGN0eC5saW5lVG8oZW5kVmFsWzBdLCBlbmRWYWxbMV0pO1xuICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogVGhyZWUgZnJhbWUgYW5pbWF0aW9uIG9mIGEgdGhpbm5pbmcgbGluZS4gQW5pbWF0aW9ucyBhcmUgZGlzcGxhY2VkIGluIHRpbWUgc28gZXZlbiBpZiB0aGUgc3RhcnQgYW5kIGVuZCBzdHJlYW1zIG1vdmVcbiAqIFRoZSBsaW5lIGRvZXNuJ3RcbiAqL1xuZnVuY3Rpb24gc3BhcmtMaW5lKHN0YXJ0OiBBeC5Qb2ludFN0cmVhbSwgZW5kOiBBeC5Qb2ludFN0cmVhbSwgY3NzX2NvbG9yOiBzdHJpbmcgfCBBeC5Db2xvclN0cmVhbSk6IEF4LkFuaW1hdGlvbiB7IC8vd2UgY291bGQgYmUgY2xldmVyIGFuZCBsZXQgc3BhcmsgdGFrZSBhIHNlcSwgYnV0IHVzZXIgZnVuY3Rpb25zIHNob3VsZCBiZSBzaW1wbGVcbiAgICByZXR1cm4gdGhpY2tMaW5lMXRpY2soNiwgLy90aGljayBsaW5lXG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCwgY3NzX2NvbG9yKVxuICAgICAgICAudGhlbih0aGlja0xpbmUxdGljaygyLCAvL21lZGl1bSBsaW5lXG4gICAgICAgICAgICBBeC5kaXNwbGFjZVQoLTAuMSwgc3RhcnQpLFxuICAgICAgICAgICAgQXguZGlzcGxhY2VUKC0wLjEsIGVuZCksXG4gICAgICAgICAgICBjc3NfY29sb3IpKVxuICAgICAgICAudGhlbih0aGlja0xpbmUxdGljaygxLCAvL3RoaW4gbGluZVxuICAgICAgICAgICAgQXguZGlzcGxhY2VUKC0wLjIsIHN0YXJ0KSxcbiAgICAgICAgICAgIEF4LmRpc3BsYWNlVCgtMC4yLCBlbmQpLFxuICAgICAgICAgICAgY3NzX2NvbG9yKSk7XG59XG5cbi8vbGFyZ2UgY2lyY2xlIGZ1bmNpdG9uc1xudmFyIGJpZ1NpbiA9IEF4LnNpbigxKS5tYXAoeCA9PiB4ICogNDAgKyA1MCk7XG52YXIgYmlnQ29zID0gQXguY29zKDEpLm1hcCh4ID0+IHggKiA0MCArIDUwKTtcblxuLy9wZXJpb2RpYyBjb2xvclxudmFyIHJlZCAgID0gMjU1O1xudmFyIGdyZWVuID0gQXguc2luKDIpLm1hcCh4ID0+IHggKiAxMDAgKyA1NSk7XG52YXIgYmx1ZSA9IDUwO1xuXG5cbmFuaW1hdG9yLnBsYXkoQXguY2hhbmdlQ29sb3IoXCIjMDAwMDAwXCIsIEF4LnJlY3QoWzAsMF0sWzEwMCwxMDBdKSkpOyAvL2RyYXcgYmxhY2sgYmFja2dyb3VuZFxuYW5pbWF0b3IucGxheShcbiAgICAgICAgQXguZW1pdChcbiAgICAgICAgICAgICAgICBzcGFya0xpbmUoXG4gICAgICAgICAgICAgICAgICAgIEF4LnBvaW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgYmlnU2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgYmlnQ29zXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIEF4LmRpc3BsYWNlVCgtMC4xLFxuICAgICAgICAgICAgICAgICAgICAgICAgQXgucG9pbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmlnU2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpZ0Nvc1xuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBBeC5jb2xvcihyZWQsZ3JlZW4sYmx1ZSwwLjUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgKTtcblxudHJ5IHtcbiAgICAvL2Jyb3dzZXJcbiAgICB2YXIgdGltZTtcbiAgICB2YXIgcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVuZGVyKTtcbiAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxuICAgICAgICAgICAgZHQgPSBub3cgLSAodGltZSB8fCBub3cpO1xuICAgICAgICB0aW1lID0gbm93O1xuICAgICAgICBhbmltYXRvci5yb290Lm9uTmV4dChuZXcgQXguRHJhd1RpY2soYW5pbWF0b3IuY3R4LCAwLCBkdC8xMDAwKSk7XG4gICAgfTtcbiAgICByZW5kZXIoKTtcbn0gY2F0Y2goZXJyKSB7XG4gICAgLy9ub2RlLmpzXG4gICAgYW5pbWF0b3IucGxheShBeC5zYXZlKDEwMCwgMTAwLCBcImltYWdlcy90dXRvcmlhbDIuZ2lmXCIpKTtcbiAgICBhbmltYXRvci50aWNrZXIoUnguT2JzZXJ2YWJsZS5yZXR1cm4oMC4xKS5yZXBlYXQoMjApKTtcbn1cblxuaGVscGVyLnBsYXlFeGFtcGxlKFwiZXhhbXBsZTJcIiwgMjAsIGFuaW1hdG9yKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=