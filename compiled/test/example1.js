/// <reference path="../node_modules/rx/ts/rx.all.d.ts" />
/// <reference path="../types/node.d.ts" />
/// <reference path="../types/should.d.ts" />
require('source-map-support').install();
var Ax = require("../src/animaxe");
var Rx = require("rx");
//create an animator, at 30FPS
try {
    var canvas = document.getElementById("canvas");
    console.log("browser", canvas);
}
catch (err) {
    console.log(err);
    var Canvas = require('canvas');
    var canvas = new Canvas(100, 100);
    console.log("node", canvas);
}
console.log("context", context);
var context = canvas.getContext('2d');
var animator = new Ax.Animator(context); /*should be based on context*/
//2 frame animated glow
function spark(css_color) {
    var css = Ax.toStreamColor(css_color);
    return Ax.take(1, Ax.draw(function (tick) {
        console.log("spark: frame1", css.next());
        tick.ctx.fillStyle = css.next();
        tick.ctx.fillRect(-2, -2, 5, 5);
    })).then(Ax.take(1, Ax.draw(function (tick) {
        console.log("spark: frame2", css.next());
        tick.ctx.fillStyle = css.next();
        tick.ctx.fillRect(-1, -1, 3, 3);
    })));
}
function sparkLong(css_color) {
    return Ax.draw(function (tick) {
        console.log("sparkLong", css_color);
        tick.ctx.fillStyle = css_color;
        tick.ctx.fillRect(-1, -1, 3, 3);
    });
}
//large circle funcitons
var bigSin = Ax.sin(1).map(function (x) { return x * 40 + 50; });
var bigCos = Ax.cos(1).map(function (x) { return x * 40 + 50; });
var red = Ax.sin(2).map(function (x) { return x * 125 + 125; });
var green = Ax.sin(2).map(function (x) { return x * 55 + 200; });
animator.play(Ax.changeColor("#000000", Ax.rect([0, 0], [100, 100]))); //draw black background
animator.play(Ax.loop(Ax.move(Ax.point(bigSin, bigCos), spark(Ax.color(red, green, 0, 0.5))))); //spinning spark forever
animator.play(Ax.move([50, 50], Ax.velocity([50, 0], Ax.loop(spark("#FFFFFF"))))); //constant move
animator.play(Ax.tween_linear([50, 50], Ax.point(bigSin, bigCos), 1, Ax.loop(spark("red")))); //spiral 1 second
try {
    //browser
    var time;
    var render = function () {
        window.requestAnimationFrame(render);
        var now = new Date().getTime(), dt = now - (time || now);
        time = now;
        animator.root.onNext(new Ax.DrawTick(animator.ctx, dt / 1000));
    };
    render();
}
catch (err) {
    //node.js
    animator.play(Ax.save(100, 100, "images/tutorial1.gif"));
    animator.ticker(Rx.Observable.return(0.1).repeat(20));
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4YW1wbGUxLnRzIl0sIm5hbWVzIjpbInNwYXJrIiwic3BhcmtMb25nIl0sIm1hcHBpbmdzIjoiQUFBQSxBQUdBLDBEQUgwRDtBQUMxRCwyQ0FBMkM7QUFDM0MsNkNBQTZDO0FBQzdDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBQ3hDLElBQU8sRUFBRSxXQUFXLGdCQUFnQixDQUFDLENBQUM7QUFDdEMsSUFBTyxFQUFFLFdBQVcsSUFBSSxDQUFDLENBQUM7QUFFMUIsQUFDQSw4QkFEOEI7SUFDMUIsQ0FBQztJQUNELElBQUksTUFBTSxHQUFPLFFBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDbkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDbkMsQ0FBRTtBQUFBLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDWCxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2pCLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMvQixJQUFJLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDbEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDaEMsQ0FBQztBQUVELE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ2hDLElBQUksT0FBTyxHQUE2QixNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBR2hFLElBQUksUUFBUSxHQUFnQixJQUFJLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEVBQUUsOEJBQUQsQUFBK0I7QUFHcEYsQUFDQSx1QkFEdUI7ZUFDUixTQUFrQztJQUM3Q0EsSUFBSUEsR0FBR0EsR0FBR0EsRUFBRUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsQ0FBQ0E7SUFDdENBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLFVBQVNBLElBQWlCQTtRQUM1QyxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUN6QyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3JDLENBQUMsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FDSkEsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBU0EsSUFBaUJBO1FBQ3pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ3pDLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxHQUFHLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNoQyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakMsQ0FBQyxDQUFDQSxDQUFDQSxDQUNOQSxDQUFDQTtBQUNOQSxDQUFDQTtBQUVELG1CQUFtQixTQUFpQjtJQUNoQ0MsTUFBTUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBU0EsSUFBaUJBO1FBQ2pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUMvQixJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7SUFDckMsQ0FBQyxDQUFDQSxDQUFDQTtBQUNQQSxDQUFDQTtBQUVELEFBQ0Esd0JBRHdCO0lBQ3BCLE1BQU0sR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFYLENBQVcsQ0FBQyxDQUFDO0FBQzdDLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQVgsQ0FBVyxDQUFDLENBQUM7QUFFN0MsSUFBSSxHQUFHLEdBQUssRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsRUFBYixDQUFhLENBQUMsQ0FBQztBQUM5QyxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsR0FBRyxFQUFFLEdBQUcsR0FBRyxFQUFaLENBQVksQ0FBQyxDQUFDO0FBRTdDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEdBQUcsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSx1QkFBdUI7QUFDM0YsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFDLEtBQUssRUFBQyxDQUFDLEVBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSx3QkFBd0I7QUFDckgsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEVBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxlQUFlO0FBQ2hHLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxDQUFDLEVBQUUsRUFBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsaUJBQWlCO0FBRzlHLElBQUksQ0FBQztJQUNELEFBQ0EsU0FEUztRQUNMLElBQUksQ0FBQztJQUNULElBQUksTUFBTSxHQUFHO1FBQ1QsTUFBTSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JDLElBQUksR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEVBQzFCLEVBQUUsR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLElBQUksR0FBRyxDQUFDLENBQUM7UUFDN0IsSUFBSSxHQUFHLEdBQUcsQ0FBQztRQUNYLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFLEVBQUUsR0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ2pFLENBQUMsQ0FBQztJQUNGLE1BQU0sRUFBRSxDQUFDO0FBQ2IsQ0FBRTtBQUFBLEtBQUssQ0FBQSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDVixBQUNBLFNBRFM7SUFDVCxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxzQkFBc0IsQ0FBQyxDQUFDLENBQUM7SUFDekQsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztBQUMxRCxDQUFDIiwiZmlsZSI6ImV4YW1wbGUxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL25vZGVfbW9kdWxlcy9yeC90cy9yeC5hbGwuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwZXMvbm9kZS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBlcy9zaG91bGQuZC50c1wiIC8+XG5yZXF1aXJlKCdzb3VyY2UtbWFwLXN1cHBvcnQnKS5pbnN0YWxsKCk7XG5pbXBvcnQgQXggPSByZXF1aXJlKFwiLi4vc3JjL2FuaW1heGVcIik7XG5pbXBvcnQgUnggPSByZXF1aXJlKFwicnhcIik7XG5cbi8vY3JlYXRlIGFuIGFuaW1hdG9yLCBhdCAzMEZQU1xudHJ5IHtcbiAgICB2YXIgY2FudmFzOmFueSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpO1xuICAgIGNvbnNvbGUubG9nKFwiYnJvd3NlclwiLCBjYW52YXMpO1xufSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB2YXIgQ2FudmFzID0gcmVxdWlyZSgnY2FudmFzJyk7XG4gICAgdmFyIGNhbnZhcyA9IG5ldyBDYW52YXMoMTAwLCAxMDApO1xuICAgIGNvbnNvbGUubG9nKFwibm9kZVwiLCBjYW52YXMpO1xufVxuXG5jb25zb2xlLmxvZyhcImNvbnRleHRcIiwgY29udGV4dCk7XG52YXIgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cblxudmFyIGFuaW1hdG9yOiBBeC5BbmltYXRvciA9IG5ldyBBeC5BbmltYXRvcihjb250ZXh0KTsgLypzaG91bGQgYmUgYmFzZWQgb24gY29udGV4dCovXG5cblxuLy8yIGZyYW1lIGFuaW1hdGVkIGdsb3dcbmZ1bmN0aW9uIHNwYXJrKGNzc19jb2xvcjogc3RyaW5nIHwgQXguQ29sb3JTdHJlYW0pOiBBeC5BbmltYXRpb24geyAvL3dlIGNvdWxkIGJlIGNsZXZlciBhbmQgbGV0IHNwYXJrIHRha2UgYSBzZXEsIGJ1dCB1c2VyIGZ1bmN0aW9ucyBzaG91bGQgYmUgc2ltcGxlXG4gICAgdmFyIGNzcyA9IEF4LnRvU3RyZWFtQ29sb3IoY3NzX2NvbG9yKTtcbiAgICByZXR1cm4gQXgudGFrZSgxLCBBeC5kcmF3KGZ1bmN0aW9uKHRpY2s6IEF4LkRyYXdUaWNrKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNwYXJrOiBmcmFtZTFcIiwgY3NzLm5leHQoKSk7XG4gICAgICAgICAgICB0aWNrLmN0eC5maWxsU3R5bGUgPSBjc3MubmV4dCgpO1xuICAgICAgICAgICAgdGljay5jdHguZmlsbFJlY3QoLTIsLTIsNSw1KTtcbiAgICB9KSkudGhlbihcbiAgICAgICAgQXgudGFrZSgxLCBBeC5kcmF3KGZ1bmN0aW9uKHRpY2s6IEF4LkRyYXdUaWNrKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNwYXJrOiBmcmFtZTJcIiwgY3NzLm5leHQoKSk7XG4gICAgICAgICAgICB0aWNrLmN0eC5maWxsU3R5bGUgPSBjc3MubmV4dCgpO1xuICAgICAgICAgICAgdGljay5jdHguZmlsbFJlY3QoLTEsLTEsMywzKTtcbiAgICAgICAgfSkpXG4gICAgKTtcbn1cblxuZnVuY3Rpb24gc3BhcmtMb25nKGNzc19jb2xvcjogc3RyaW5nKTogQXguQW5pbWF0aW9uIHsgLy93ZSBjb3VsZCBiZSBjbGV2ZXIgYW5kIGxldCBzcGFyayB0YWtlIGEgc2VxLCBidXQgdXNlciBmdW5jdGlvbnMgc2hvdWxkIGJlIHNpbXBsZVxuICAgIHJldHVybiBBeC5kcmF3KGZ1bmN0aW9uKHRpY2s6IEF4LkRyYXdUaWNrKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNwYXJrTG9uZ1wiLCBjc3NfY29sb3IpO1xuICAgICAgICAgICAgdGljay5jdHguZmlsbFN0eWxlID0gY3NzX2NvbG9yO1xuICAgICAgICAgICAgdGljay5jdHguZmlsbFJlY3QoLTEsLTEsMywzKTtcbiAgICB9KTtcbn1cblxuLy9sYXJnZSBjaXJjbGUgZnVuY2l0b25zXG52YXIgYmlnU2luID0gQXguc2luKDEpLm1hcCh4ID0+IHggKiA0MCArIDUwKTtcbnZhciBiaWdDb3MgPSBBeC5jb3MoMSkubWFwKHggPT4geCAqIDQwICsgNTApO1xuXG52YXIgcmVkICAgPSBBeC5zaW4oMikubWFwKHggPT4geCAqIDEyNSArIDEyNSk7XG52YXIgZ3JlZW4gPSBBeC5zaW4oMikubWFwKHggPT4geCAqIDU1ICsgMjAwKTtcblxuYW5pbWF0b3IucGxheShBeC5jaGFuZ2VDb2xvcihcIiMwMDAwMDBcIiwgQXgucmVjdChbMCwwXSxbMTAwLDEwMF0pKSk7IC8vZHJhdyBibGFjayBiYWNrZ3JvdW5kXG5hbmltYXRvci5wbGF5KEF4Lmxvb3AoQXgubW92ZShBeC5wb2ludChiaWdTaW4sIGJpZ0NvcyksIHNwYXJrKEF4LmNvbG9yKHJlZCxncmVlbiwwLDAuNSkpKSkpOyAvL3NwaW5uaW5nIHNwYXJrIGZvcmV2ZXJcbmFuaW1hdG9yLnBsYXkoQXgubW92ZShbNTAsNTBdLCBBeC52ZWxvY2l0eShbNTAsMF0sIEF4Lmxvb3Aoc3BhcmsoXCIjRkZGRkZGXCIpKSkpKTsgLy9jb25zdGFudCBtb3ZlXG5hbmltYXRvci5wbGF5KEF4LnR3ZWVuX2xpbmVhcihbNTAsNTBdLCBBeC5wb2ludChiaWdTaW4sIGJpZ0NvcyksIDEsIEF4Lmxvb3Aoc3BhcmsoXCJyZWRcIikpKSk7IC8vc3BpcmFsIDEgc2Vjb25kXG5cblxudHJ5IHtcbiAgICAvL2Jyb3dzZXJcbiAgICB2YXIgdGltZTtcbiAgICB2YXIgcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVuZGVyKTtcbiAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxuICAgICAgICAgICAgZHQgPSBub3cgLSAodGltZSB8fCBub3cpO1xuICAgICAgICB0aW1lID0gbm93O1xuICAgICAgICBhbmltYXRvci5yb290Lm9uTmV4dChuZXcgQXguRHJhd1RpY2soYW5pbWF0b3IuY3R4LCBkdC8xMDAwKSk7XG4gICAgfTtcbiAgICByZW5kZXIoKTtcbn0gY2F0Y2goZXJyKSB7XG4gICAgLy9ub2RlLmpzXG4gICAgYW5pbWF0b3IucGxheShBeC5zYXZlKDEwMCwgMTAwLCBcImltYWdlcy90dXRvcmlhbDEuZ2lmXCIpKTtcbiAgICBhbmltYXRvci50aWNrZXIoUnguT2JzZXJ2YWJsZS5yZXR1cm4oMC4xKS5yZXBlYXQoMjApKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==