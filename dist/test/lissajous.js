// THIS IS AUTO GENERATED TEST CODE, DO NOT MODIFY DIRECTLY
/// <reference path="../types/should.d.ts" />
/// <reference path="../types/mocha.d.ts" />
/// <reference path="../types/node.d.ts" />
require('source-map-support').install();
require("should");
var Ax = require("../src/animaxe");
var helper = require("../src/helper");
var Parameter = require("../src/Parameter");
var animator = helper.getExampleAnimator(100, 100);
//each frame, first draw black background to erase the previous contents
animator.play(Ax.create().fillStyle("#000000").fillRect([0, 0], [100, 100]));
/**
 *
 * A time varying set of 2D parametric equations.
 * https://en.wikipedia.org/wiki/Lissajous_curve.
 * Paramteric equations over P,  P -> x = Asin(aP + i), y = Bsin(bP)
 * ( Normally parametric equations are described using parameter t, but this is confusing
 * with the time tick so I used P to describe the free parameter in the parametric equations)
 * At each time tick, t, a lissajous curve is generated from the time-varying A,a,B,b,i parameters
 */
function lissajous(A, a, B, b, i) {
    return Parameter.from(A).combine(function () { return function (A, a, B, b, i) {
        return [function (t) { return A * Math.sin(a * t + i); }, function (t) { return B * Math.sin(b * t); }];
    }; }, Parameter.from(a), Parameter.from(B), Parameter.from(b), Parameter.from(i));
}
var twoPi = 2 * Math.PI;
// We use a numerical approximation 'trace' to sample enough P's to approximate the curve with a point list
// So every time tick, we pick some time varying numbers chosen artistically
// we pass them through lissajous to generate some parametric equations
// we then trace that to turn it into a pointlist. 
// So we have transformed the (arbitary) time varying parameters, to a time varying list of points 
var timeVaryingPointList = (Parameter.trace(lissajous(45, Parameter.t().mapValue(function (t) { return 2 + Math.sin(t); }), 45, Parameter.t().mapValue(function (t) { return 2 + Math.sin(t / 2); }), Parameter.t()), Parameter.t().mapValue(function (t) { return t % twoPi; }), Parameter.t().mapValue(function (t) { return (t % twoPi) + twoPi; }), 10, 4, 100000).mapValue(function (array) {
    return array.map(function (segment) { return segment.point; });
}));
// To render a time varying list of points as a joined up line, each frame we chain a moveTo and many lineTo animations together.
// As canvas animation persist over time forever, we have to use take(1) to limit the length of the animations to one frame.
// playAll is able to play a new animation generated from a time varying stream of animations.
// we can chain many animations based on values from a list, by reducing over the start of the animation chain.        
animator.play(Ax.create()
    .beginPath()
    .playAll(timeVaryingPointList.mapValue(// time varying point set is mapped to a time varying animation for squencing each frame
function (pointList) {
    // Convert the list of points into a single animation chain
    return pointList.reduce(function (animation, point, index) {
        return index == 0 ? animation.moveTo(point) : animation.lineTo(point);
    }, 
    // Start of chain, blank animation with take(1)
    // the take(1) ensure the played animation lasts 1 frame
    Ax.create().translate([50, 50]).take(1));
}))
    .strokeStyle("green")
    .lineWidth(3)
    .stroke());
helper.playExample("lissajous", 64, animator, 100, 100);
describe('lissajous', function () {
    it('should match the reference', function (done) {
        helper.sameExample("lissajous", "lissajous-ref", function (equal) {
            equal.should.equal(true);
            done();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4YW1wbGUudGVtcGxhdGUudHMiXSwibmFtZXMiOlsibGlzc2Fqb3VzIl0sIm1hcHBpbmdzIjoiQUFBQSwyREFBMkQ7QUFDM0QsNkNBQTZDO0FBQzdDLDRDQUE0QztBQUM1QywyQ0FBMkM7QUFDM0MsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDeEMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBR2xCLElBQVksRUFBRSxXQUFNLGdCQUFnQixDQUFDLENBQUE7QUFDckMsSUFBWSxNQUFNLFdBQU0sZUFBZSxDQUFDLENBQUE7QUFFeEMsSUFBWSxTQUFTLFdBQU0sa0JBQWtCLENBQUMsQ0FBQTtBQU05QyxJQUFJLFFBQVEsR0FBZ0IsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUVoRSx3RUFBd0U7QUFDeEUsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEdBQUcsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFFMUU7Ozs7Ozs7O0dBUUc7QUFDSCxtQkFDUSxDQUFlLEVBQUUsQ0FBZSxFQUNoQyxDQUFlLEVBQUUsQ0FBZSxFQUNoQyxDQUFlO0lBRW5CQSxNQUFNQSxDQUFDQSxTQUFTQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxPQUFPQSxDQUM1QkEsY0FBTUEsT0FBQUEsVUFBQ0EsQ0FBU0EsRUFBRUEsQ0FBU0EsRUFBRUEsQ0FBU0EsRUFBRUEsQ0FBU0EsRUFBRUEsQ0FBU0E7ZUFDeERBLENBQUNBLFVBQUNBLENBQVNBLElBQUtBLE9BQUFBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEVBQXZCQSxD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LENBQUMsV0FBVyxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBR3hELFFBQVEsQ0FBQyxXQUFXLEVBQUU7SUFDbEIsRUFBRSxDQUFFLDRCQUE0QixFQUFFLFVBQVMsSUFBSTtRQUMzQyxNQUFNLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxlQUFlLEVBQUUsVUFBUyxLQUFLO1lBQzNELEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3pCLElBQUksRUFBRSxDQUFDO1FBQ1gsQ0FBQyxDQUFDLENBQUE7SUFDTixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6ImRpc3QvdGVzdC9saXNzYWpvdXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUSElTIElTIEFVVE8gR0VORVJBVEVEIFRFU1QgQ09ERSwgRE8gTk9UIE1PRElGWSBESVJFQ1RMWVxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGVzL3Nob3VsZC5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBlcy9tb2NoYS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBlcy9ub2RlLmQudHNcIiAvPlxucmVxdWlyZSgnc291cmNlLW1hcC1zdXBwb3J0JykuaW5zdGFsbCgpO1xucmVxdWlyZShcInNob3VsZFwiKTtcblxuaW1wb3J0ICogYXMgUnggZnJvbSBcInJ4XCI7XG5pbXBvcnQgKiBhcyBBeCBmcm9tIFwiLi4vc3JjL2FuaW1heGVcIjtcbmltcG9ydCAqIGFzIGhlbHBlciBmcm9tIFwiLi4vc3JjL2hlbHBlclwiO1xuaW1wb3J0ICogYXMgZXZlbnRzIGZyb20gXCIuLi9zcmMvZXZlbnRzXCI7XG5pbXBvcnQgKiBhcyBQYXJhbWV0ZXIgZnJvbSBcIi4uL3NyYy9QYXJhbWV0ZXJcIjtcbmltcG9ydCAqIGFzIHBhcmFtZXRyaWMgZnJvbSBcIi4uL3NyYy9wYXJhbWV0cmljXCI7XG5pbXBvcnQgKiBhcyBPVCBmcm9tIFwiLi4vc3JjL09ic2VydmFibGVUcmFuc2Zvcm1lclwiOyAvLyBUT0RPIHRoaXMgc2hvdWxkIGJlIGluIEF4XG5pbXBvcnQgKiBhcyB0eXBlcyBmcm9tIFwiLi4vc3JjL3R5cGVzXCI7IC8vIFRPRE8gdGhpcyBzaG91bGQgYmUgaW4gQXhcbmltcG9ydCAqIGFzIGNhbnZhcyBmcm9tIFwiLi4vc3JjL0NhbnZhc0FuaW1hdGlvblwiOyAvLyBUT0RPIHRoaXMgc2hvdWxkIGJlIGluIEF4XG5cbnZhciBhbmltYXRvcjogQXguQW5pbWF0b3IgPSBoZWxwZXIuZ2V0RXhhbXBsZUFuaW1hdG9yKDEwMCwgMTAwKTtcblxuLy9lYWNoIGZyYW1lLCBmaXJzdCBkcmF3IGJsYWNrIGJhY2tncm91bmQgdG8gZXJhc2UgdGhlIHByZXZpb3VzIGNvbnRlbnRzXG5hbmltYXRvci5wbGF5KEF4LmNyZWF0ZSgpLmZpbGxTdHlsZShcIiMwMDAwMDBcIikuZmlsbFJlY3QoWzAsMF0sWzEwMCwxMDBdKSk7XG5cbi8qKlxuICogXG4gKiBBIHRpbWUgdmFyeWluZyBzZXQgb2YgMkQgcGFyYW1ldHJpYyBlcXVhdGlvbnMuXG4gKiBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9MaXNzYWpvdXNfY3VydmUuXG4gKiBQYXJhbXRlcmljIGVxdWF0aW9ucyBvdmVyIFAsICBQIC0+IHggPSBBc2luKGFQICsgaSksIHkgPSBCc2luKGJQKVxuICogKCBOb3JtYWxseSBwYXJhbWV0cmljIGVxdWF0aW9ucyBhcmUgZGVzY3JpYmVkIHVzaW5nIHBhcmFtZXRlciB0LCBidXQgdGhpcyBpcyBjb25mdXNpbmdcbiAqIHdpdGggdGhlIHRpbWUgdGljayBzbyBJIHVzZWQgUCB0byBkZXNjcmliZSB0aGUgZnJlZSBwYXJhbWV0ZXIgaW4gdGhlIHBhcmFtZXRyaWMgZXF1YXRpb25zKVxuICogQXQgZWFjaCB0aW1lIHRpY2ssIHQsIGEgbGlzc2Fqb3VzIGN1cnZlIGlzIGdlbmVyYXRlZCBmcm9tIHRoZSB0aW1lLXZhcnlpbmcgQSxhLEIsYixpIHBhcmFtZXRlcnNcbiAqL1xuZnVuY3Rpb24gbGlzc2Fqb3VzKFxuICAgICAgICBBOiBBeC5OdW1iZXJBcmcsIGE6IEF4Lk51bWJlckFyZyxcbiAgICAgICAgQjogQXguTnVtYmVyQXJnLCBiOiBBeC5OdW1iZXJBcmcsIFxuICAgICAgICBpOiBBeC5OdW1iZXJBcmcpXG4gICAgOiBQYXJhbWV0ZXIuUGFyYW1ldGVyPCgodDogbnVtYmVyKSA9PiBudW1iZXIpW10+IHtcbiAgICByZXR1cm4gUGFyYW1ldGVyLmZyb20oQSkuY29tYmluZShcbiAgICAgICAgKCkgPT4gKEE6IG51bWJlciwgYTogbnVtYmVyLCBCOiBudW1iZXIsIGI6IG51bWJlciwgaTogbnVtYmVyKSA9PiBcbiAgICAgICAgICAgIFsodDogbnVtYmVyKSA9PiBBICogTWF0aC5zaW4oYSAqIHQgKyBpKSwgKHQ6IG51bWJlcikgPT4gQiAqIE1hdGguc2luKGIgKiB0KV0sXG4gICAgICAgIFBhcmFtZXRlci5mcm9tKGEpLFxuICAgICAgICBQYXJhbWV0ZXIuZnJvbShCKSxcbiAgICAgICAgUGFyYW1ldGVyLmZyb20oYiksXG4gICAgICAgIFBhcmFtZXRlci5mcm9tKGkpXG4gICAgKVxufVxuXG52YXIgdHdvUGkgPSAyICogTWF0aC5QSTtcblxuLy8gV2UgdXNlIGEgbnVtZXJpY2FsIGFwcHJveGltYXRpb24gJ3RyYWNlJyB0byBzYW1wbGUgZW5vdWdoIFAncyB0byBhcHByb3hpbWF0ZSB0aGUgY3VydmUgd2l0aCBhIHBvaW50IGxpc3Rcbi8vIFNvIGV2ZXJ5IHRpbWUgdGljaywgd2UgcGljayBzb21lIHRpbWUgdmFyeWluZyBudW1iZXJzIGNob3NlbiBhcnRpc3RpY2FsbHlcbi8vIHdlIHBhc3MgdGhlbSB0aHJvdWdoIGxpc3Nham91cyB0byBnZW5lcmF0ZSBzb21lIHBhcmFtZXRyaWMgZXF1YXRpb25zXG4vLyB3ZSB0aGVuIHRyYWNlIHRoYXQgdG8gdHVybiBpdCBpbnRvIGEgcG9pbnRsaXN0LiBcbi8vIFNvIHdlIGhhdmUgdHJhbnNmb3JtZWQgdGhlIChhcmJpdGFyeSkgdGltZSB2YXJ5aW5nIHBhcmFtZXRlcnMsIHRvIGEgdGltZSB2YXJ5aW5nIGxpc3Qgb2YgcG9pbnRzIFxudmFyIHRpbWVWYXJ5aW5nUG9pbnRMaXN0OiAvKlBhcmFtZXRlci5QYXJhbWV0ZXI8bnVtYmVyW11bXT4qLyBPVC5PYnNlcnZhYmxlVHJhbnNmb3JtZXI8Y2FudmFzLkNhbnZhc1RpY2ssIG51bWJlcltdW10+ID0gXG4gICAgKFBhcmFtZXRlci50cmFjZShcbiAgICAgICAgbGlzc2Fqb3VzKDQ1LCBQYXJhbWV0ZXIudCgpLm1hcFZhbHVlKHQgPT4gMiArIE1hdGguc2luKHQpKSwgNDUsIFBhcmFtZXRlci50KCkubWFwVmFsdWUodCA9PiAyICsgTWF0aC5zaW4odC8yKSksIFBhcmFtZXRlci50KCkpLFxuICAgICAgICBQYXJhbWV0ZXIudCgpLm1hcFZhbHVlKHQgPT4gdCAlIHR3b1BpKSwgUGFyYW1ldGVyLnQoKS5tYXBWYWx1ZSh0ID0+ICh0ICUgdHdvUGkpICsgdHdvUGkpLFxuICAgICAgICAxMCxcbiAgICAgICAgNCxcbiAgICAgICAgMTAwMDAwXG4gICAgKS5tYXBWYWx1ZSgoYXJyYXk6IHtwb2ludDogbnVtYmVyW10sIHQ6IG51bWJlcn1bXSkgPT4ge1xuICAgICAgICByZXR1cm4gYXJyYXkubWFwKHNlZ21lbnQgPT4gc2VnbWVudC5wb2ludCk7XG4gICAgfSkpO1xuICAgICAgICAgICBcbiAgICAgICAgICAgXG4vLyBUbyByZW5kZXIgYSB0aW1lIHZhcnlpbmcgbGlzdCBvZiBwb2ludHMgYXMgYSBqb2luZWQgdXAgbGluZSwgZWFjaCBmcmFtZSB3ZSBjaGFpbiBhIG1vdmVUbyBhbmQgbWFueSBsaW5lVG8gYW5pbWF0aW9ucyB0b2dldGhlci5cbi8vIEFzIGNhbnZhcyBhbmltYXRpb24gcGVyc2lzdCBvdmVyIHRpbWUgZm9yZXZlciwgd2UgaGF2ZSB0byB1c2UgdGFrZSgxKSB0byBsaW1pdCB0aGUgbGVuZ3RoIG9mIHRoZSBhbmltYXRpb25zIHRvIG9uZSBmcmFtZS5cbi8vIHBsYXlBbGwgaXMgYWJsZSB0byBwbGF5IGEgbmV3IGFuaW1hdGlvbiBnZW5lcmF0ZWQgZnJvbSBhIHRpbWUgdmFyeWluZyBzdHJlYW0gb2YgYW5pbWF0aW9ucy5cbi8vIHdlIGNhbiBjaGFpbiBtYW55IGFuaW1hdGlvbnMgYmFzZWQgb24gdmFsdWVzIGZyb20gYSBsaXN0LCBieSByZWR1Y2luZyBvdmVyIHRoZSBzdGFydCBvZiB0aGUgYW5pbWF0aW9uIGNoYWluLiAgICAgICAgXG5hbmltYXRvci5wbGF5KFxuICAgIEF4LmNyZWF0ZSgpXG4vLy50cmFuc2xhdGUoWzUwLCA1MF0pICBCVUcgVEhJUyBET0VTTidUIFdPUksgSEVSRT8gICAgXG4gICAgLmJlZ2luUGF0aCgpXG4gICAgLnBsYXlBbGwoXG4gICAgICAgIHRpbWVWYXJ5aW5nUG9pbnRMaXN0Lm1hcFZhbHVlKCAvLyB0aW1lIHZhcnlpbmcgcG9pbnQgc2V0IGlzIG1hcHBlZCB0byBhIHRpbWUgdmFyeWluZyBhbmltYXRpb24gZm9yIHNxdWVuY2luZyBlYWNoIGZyYW1lXG4gICAgICAgICAgICAocG9pbnRMaXN0OiBudW1iZXJbXVtdKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gQ29udmVydCB0aGUgbGlzdCBvZiBwb2ludHMgaW50byBhIHNpbmdsZSBhbmltYXRpb24gY2hhaW5cbiAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnRMaXN0LnJlZHVjZSgoYW5pbWF0aW9uLCBwb2ludDogbnVtYmVyW10sIGluZGV4Om51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXggPT0gMCA/IGFuaW1hdGlvbi5tb3ZlVG8ocG9pbnQpOiBhbmltYXRpb24ubGluZVRvKHBvaW50KVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgb2YgY2hhaW4sIGJsYW5rIGFuaW1hdGlvbiB3aXRoIHRha2UoMSlcbiAgICAgICAgICAgICAgICAvLyB0aGUgdGFrZSgxKSBlbnN1cmUgdGhlIHBsYXllZCBhbmltYXRpb24gbGFzdHMgMSBmcmFtZVxuICAgICAgICAgICAgICAgIEF4LmNyZWF0ZSgpLnRyYW5zbGF0ZShbNTAsIDUwXSkudGFrZSgxKSk7IFxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgKVxuICAgIC5zdHJva2VTdHlsZShcImdyZWVuXCIpXG4gICAgLmxpbmVXaWR0aCgzKVxuICAgIC5zdHJva2UoKVxuKTtcblxuaGVscGVyLnBsYXlFeGFtcGxlKFwibGlzc2Fqb3VzXCIsIDY0LCBhbmltYXRvciwgMTAwLCAxMDApO1xuXG5cbmRlc2NyaWJlKCdsaXNzYWpvdXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQgKCdzaG91bGQgbWF0Y2ggdGhlIHJlZmVyZW5jZScsIGZ1bmN0aW9uKGRvbmUpIHtcbiAgICAgICAgaGVscGVyLnNhbWVFeGFtcGxlKFwibGlzc2Fqb3VzXCIsIFwibGlzc2Fqb3VzLXJlZlwiLCBmdW5jdGlvbihlcXVhbCkge1xuICAgICAgICAgICAgZXF1YWwuc2hvdWxkLmVxdWFsKHRydWUpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9KVxuICAgIH0pO1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
