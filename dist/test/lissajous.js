// THIS IS AUTO GENERATED TEST CODE, DO NOT MODIFY DIRECTLY
/// <reference path="../types/should.d.ts" />
/// <reference path="../types/mocha.d.ts" />
/// <reference path="../types/node.d.ts" />
require('source-map-support').install();
require("should");
var Ax = require("../src/animaxe");
var helper = require("../src/helper");
var Parameter = require("../src/Parameter");
var animator = helper.getExampleAnimator(100, 100);
//each frame, first draw black background to erase the previous contents
animator.play(Ax.create().fillStyle("#000000").fillRect([0, 0], [100, 100]));
/**
 *
 * A time varying set of 2D parametric equations.
 * https://en.wikipedia.org/wiki/Lissajous_curve.
 * Paramteric equations over P,  P -> x = Asin(aP + i), y = Bsin(bP)
 * ( Normally parametric equations are described using parameter t, but this is confusing
 * with the time tick so I used P to describe the free parameter in the parametric equations)
 * At each time tick, t, a lissajous curve is generated from the time-varying A,a,B,b,i parameters
 */
function lissajous(A, a, B, b, i) {
    return Parameter.from(A).combine(function () { return function (A, a, B, b, i) {
        return [function (t) { return A * Math.sin(a * t + i); }, function (t) { return B * Math.sin(b * t); }];
    }; }, Parameter.from(a), Parameter.from(B), Parameter.from(b), Parameter.from(i));
}
var twoPi = 2 * Math.PI;
// We use a numerical approximation 'trace' to sample enough P's to approximate the curve with a point list
// So every time tick, we pick some time varying numbers chosen artistically
// we pass them through lissajous to generate some parametric equations
// we then trace that to turn it into a pointlist. 
// So we have transformed the (arbitary) time varying parameters, to a time varying list of points 
var timeVaryingPointList = Parameter.trace(lissajous(45, Parameter.t().mapValue(function (t) { return 2 + Math.sin(t); }), 45, Parameter.t().mapValue(function (t) { return 2 + Math.sin(t / 2); }), Parameter.t()), Parameter.t().mapValue(function (t) { return t % twoPi; }), Parameter.t().mapValue(function (t) { return (t % twoPi) + twoPi; }), 10, 4, 100000).mapValue(function (array) {
    return array.map(function (segment) { return segment.point; });
});
// To render a time varying list of points as a joined up line, each frame we chain a moveTo and many lineTo animations together.
// As canvas animation persist over time forever, we have to use take(1) to limit the length of the animations to one frame.
// playAll is able to play a new animation generated from a time varying stream of animations.
// we can chain many animations based on values from a list, by reducing over the start of the animation chain.        
animator.play(Ax.create()
    .beginPath()
    .playAll(timeVaryingPointList.mapValue(// time varying point set is mapped to a time varying animation for squencing each frame
function (pointList) {
    // Convert the list of points into a single animation chain
    return pointList.reduce(function (animation, point, index) {
        return index == 0 ? animation.moveTo(point) : animation.lineTo(point);
    }, 
    // Start of chain, blank animation with take(1)
    // the take(1) ensure the played animation lasts 1 frame
    Ax.create().translate([50, 50]).take(1));
}))
    .strokeStyle("green")
    .lineWidth(3)
    .stroke());
helper.playExample("lissajous", 64, animator, 100, 100);
describe('lissajous', function () {
    it('should match the reference', function (done) {
        helper.sameExample("lissajous", "lissajous-ref", function (equal) {
            equal.should.equal(true);
            done();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4YW1wbGUudGVtcGxhdGUudHMiXSwibmFtZXMiOlsibGlzc2Fqb3VzIl0sIm1hcHBpbmdzIjoiQUFBQSwyREFBMkQ7QUFDM0QsNkNBQTZDO0FBQzdDLDRDQUE0QztBQUM1QywyQ0FBMkM7QUFDM0MsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDeEMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBR2xCLElBQVksRUFBRSxXQUFNLGdCQUFnQixDQUFDLENBQUE7QUFDckMsSUFBWSxNQUFNLFdBQU0sZUFBZSxDQUFDLENBQUE7QUFFeEMsSUFBWSxTQUFTLFdBQU0sa0JBQWtCLENBQUMsQ0FBQTtBQU05QyxJQUFJLFFBQVEsR0FBZ0IsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUVoRSx3RUFBd0U7QUFDeEUsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEdBQUcsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFFMUU7Ozs7Ozs7O0dBUUc7QUFDSCxtQkFDUSxDQUFlLEVBQUUsQ0FBZSxFQUNoQyxDQUFlLEVBQUUsQ0FBZSxFQUNoQyxDQUFlO0lBRW5CQSxNQUFNQSxDQUFDQSxTQUFTQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxPQUFPQSxDQUM1QkEsY0FBTUEsT0FBQUEsVUFBQ0EsQ0FBU0EsRUFBRUEsQ0FBU0EsRUFBRUEsQ0FBU0EsRUFBRUEsQ0FBU0EsRUFBRUEsQ0FBU0E7ZUFDeERBLENBQUNBLFVBQUNBLENBQVNBLElBQUtBLE9BQUFBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEVBQXZCQSxD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LEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFHeEQsUUFBUSxDQUFDLFdBQVcsRUFBRTtJQUNsQixFQUFFLENBQUUsNEJBQTRCLEVBQUUsVUFBUyxJQUFJO1FBQzNDLE1BQU0sQ0FBQyxXQUFXLENBQUMsV0FBVyxFQUFFLGVBQWUsRUFBRSxVQUFTLEtBQUs7WUFDM0QsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDekIsSUFBSSxFQUFFLENBQUM7UUFDWCxDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoiZGlzdC90ZXN0L2xpc3Nham91cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFRISVMgSVMgQVVUTyBHRU5FUkFURUQgVEVTVCBDT0RFLCBETyBOT1QgTU9ESUZZIERJUkVDVExZXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwZXMvc2hvdWxkLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGVzL21vY2hhLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGVzL25vZGUuZC50c1wiIC8+XG5yZXF1aXJlKCdzb3VyY2UtbWFwLXN1cHBvcnQnKS5pbnN0YWxsKCk7XG5yZXF1aXJlKFwic2hvdWxkXCIpO1xuXG5pbXBvcnQgKiBhcyBSeCBmcm9tIFwicnhcIjtcbmltcG9ydCAqIGFzIEF4IGZyb20gXCIuLi9zcmMvYW5pbWF4ZVwiO1xuaW1wb3J0ICogYXMgaGVscGVyIGZyb20gXCIuLi9zcmMvaGVscGVyXCI7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSBcIi4uL3NyYy9ldmVudHNcIjtcbmltcG9ydCAqIGFzIFBhcmFtZXRlciBmcm9tIFwiLi4vc3JjL1BhcmFtZXRlclwiO1xuaW1wb3J0ICogYXMgcGFyYW1ldHJpYyBmcm9tIFwiLi4vc3JjL3BhcmFtZXRyaWNcIjtcbmltcG9ydCAqIGFzIE9UIGZyb20gXCIuLi9zcmMvZnJwXCI7IC8vIFRPRE8gdGhpcyBzaG91bGQgYmUgaW4gQXhcbmltcG9ydCAqIGFzIHR5cGVzIGZyb20gXCIuLi9zcmMvdHlwZXNcIjsgLy8gVE9ETyB0aGlzIHNob3VsZCBiZSBpbiBBeFxuaW1wb3J0ICogYXMgY2FudmFzIGZyb20gXCIuLi9zcmMvY2FudmFzXCI7IC8vIFRPRE8gdGhpcyBzaG91bGQgYmUgaW4gQXhcblxudmFyIGFuaW1hdG9yOiBBeC5BbmltYXRvciA9IGhlbHBlci5nZXRFeGFtcGxlQW5pbWF0b3IoMTAwLCAxMDApO1xuXG4vL2VhY2ggZnJhbWUsIGZpcnN0IGRyYXcgYmxhY2sgYmFja2dyb3VuZCB0byBlcmFzZSB0aGUgcHJldmlvdXMgY29udGVudHNcbmFuaW1hdG9yLnBsYXkoQXguY3JlYXRlKCkuZmlsbFN0eWxlKFwiIzAwMDAwMFwiKS5maWxsUmVjdChbMCwwXSxbMTAwLDEwMF0pKTtcblxuLyoqXG4gKiBcbiAqIEEgdGltZSB2YXJ5aW5nIHNldCBvZiAyRCBwYXJhbWV0cmljIGVxdWF0aW9ucy5cbiAqIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpc3Nham91c19jdXJ2ZS5cbiAqIFBhcmFtdGVyaWMgZXF1YXRpb25zIG92ZXIgUCwgIFAgLT4geCA9IEFzaW4oYVAgKyBpKSwgeSA9IEJzaW4oYlApXG4gKiAoIE5vcm1hbGx5IHBhcmFtZXRyaWMgZXF1YXRpb25zIGFyZSBkZXNjcmliZWQgdXNpbmcgcGFyYW1ldGVyIHQsIGJ1dCB0aGlzIGlzIGNvbmZ1c2luZ1xuICogd2l0aCB0aGUgdGltZSB0aWNrIHNvIEkgdXNlZCBQIHRvIGRlc2NyaWJlIHRoZSBmcmVlIHBhcmFtZXRlciBpbiB0aGUgcGFyYW1ldHJpYyBlcXVhdGlvbnMpXG4gKiBBdCBlYWNoIHRpbWUgdGljaywgdCwgYSBsaXNzYWpvdXMgY3VydmUgaXMgZ2VuZXJhdGVkIGZyb20gdGhlIHRpbWUtdmFyeWluZyBBLGEsQixiLGkgcGFyYW1ldGVyc1xuICovXG5mdW5jdGlvbiBsaXNzYWpvdXMoXG4gICAgICAgIEE6IEF4Lk51bWJlckFyZywgYTogQXguTnVtYmVyQXJnLFxuICAgICAgICBCOiBBeC5OdW1iZXJBcmcsIGI6IEF4Lk51bWJlckFyZywgXG4gICAgICAgIGk6IEF4Lk51bWJlckFyZylcbiAgICA6IFBhcmFtZXRlci5QYXJhbWV0ZXI8KCh0OiBudW1iZXIpID0+IG51bWJlcilbXT4ge1xuICAgIHJldHVybiBQYXJhbWV0ZXIuZnJvbShBKS5jb21iaW5lKFxuICAgICAgICAoKSA9PiAoQTogbnVtYmVyLCBhOiBudW1iZXIsIEI6IG51bWJlciwgYjogbnVtYmVyLCBpOiBudW1iZXIpID0+IFxuICAgICAgICAgICAgWyh0OiBudW1iZXIpID0+IEEgKiBNYXRoLnNpbihhICogdCArIGkpLCAodDogbnVtYmVyKSA9PiBCICogTWF0aC5zaW4oYiAqIHQpXSxcbiAgICAgICAgUGFyYW1ldGVyLmZyb20oYSksXG4gICAgICAgIFBhcmFtZXRlci5mcm9tKEIpLFxuICAgICAgICBQYXJhbWV0ZXIuZnJvbShiKSxcbiAgICAgICAgUGFyYW1ldGVyLmZyb20oaSlcbiAgICApXG59XG5cbnZhciB0d29QaSA9IDIgKiBNYXRoLlBJO1xuXG4vLyBXZSB1c2UgYSBudW1lcmljYWwgYXBwcm94aW1hdGlvbiAndHJhY2UnIHRvIHNhbXBsZSBlbm91Z2ggUCdzIHRvIGFwcHJveGltYXRlIHRoZSBjdXJ2ZSB3aXRoIGEgcG9pbnQgbGlzdFxuLy8gU28gZXZlcnkgdGltZSB0aWNrLCB3ZSBwaWNrIHNvbWUgdGltZSB2YXJ5aW5nIG51bWJlcnMgY2hvc2VuIGFydGlzdGljYWxseVxuLy8gd2UgcGFzcyB0aGVtIHRocm91Z2ggbGlzc2Fqb3VzIHRvIGdlbmVyYXRlIHNvbWUgcGFyYW1ldHJpYyBlcXVhdGlvbnNcbi8vIHdlIHRoZW4gdHJhY2UgdGhhdCB0byB0dXJuIGl0IGludG8gYSBwb2ludGxpc3QuIFxuLy8gU28gd2UgaGF2ZSB0cmFuc2Zvcm1lZCB0aGUgKGFyYml0YXJ5KSB0aW1lIHZhcnlpbmcgcGFyYW1ldGVycywgdG8gYSB0aW1lIHZhcnlpbmcgbGlzdCBvZiBwb2ludHMgXG52YXIgdGltZVZhcnlpbmdQb2ludExpc3Q6IFBhcmFtZXRlci5QYXJhbWV0ZXI8bnVtYmVyW11bXT4gPSBcbiAgICBQYXJhbWV0ZXIudHJhY2UoXG4gICAgICAgIGxpc3Nham91cyg0NSwgUGFyYW1ldGVyLnQoKS5tYXBWYWx1ZSh0ID0+IDIgKyBNYXRoLnNpbih0KSksIDQ1LCBQYXJhbWV0ZXIudCgpLm1hcFZhbHVlKHQgPT4gMiArIE1hdGguc2luKHQvMikpLCBQYXJhbWV0ZXIudCgpKSxcbiAgICAgICAgUGFyYW1ldGVyLnQoKS5tYXBWYWx1ZSh0ID0+IHQgJSB0d29QaSksIFBhcmFtZXRlci50KCkubWFwVmFsdWUodCA9PiAodCAlIHR3b1BpKSArIHR3b1BpKSxcbiAgICAgICAgMTAsXG4gICAgICAgIDQsXG4gICAgICAgIDEwMDAwMFxuICAgICkubWFwVmFsdWUoXG4gICAgICAgIChhcnJheToge3BvaW50OiBudW1iZXJbXSwgdDogbnVtYmVyfVtdKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYXJyYXkubWFwKHNlZ21lbnQgPT4gc2VnbWVudC5wb2ludCk7XG4gICAgICAgIH1cbiAgICApO1xuICAgICAgICAgICBcbiAgICAgICAgICAgXG4vLyBUbyByZW5kZXIgYSB0aW1lIHZhcnlpbmcgbGlzdCBvZiBwb2ludHMgYXMgYSBqb2luZWQgdXAgbGluZSwgZWFjaCBmcmFtZSB3ZSBjaGFpbiBhIG1vdmVUbyBhbmQgbWFueSBsaW5lVG8gYW5pbWF0aW9ucyB0b2dldGhlci5cbi8vIEFzIGNhbnZhcyBhbmltYXRpb24gcGVyc2lzdCBvdmVyIHRpbWUgZm9yZXZlciwgd2UgaGF2ZSB0byB1c2UgdGFrZSgxKSB0byBsaW1pdCB0aGUgbGVuZ3RoIG9mIHRoZSBhbmltYXRpb25zIHRvIG9uZSBmcmFtZS5cbi8vIHBsYXlBbGwgaXMgYWJsZSB0byBwbGF5IGEgbmV3IGFuaW1hdGlvbiBnZW5lcmF0ZWQgZnJvbSBhIHRpbWUgdmFyeWluZyBzdHJlYW0gb2YgYW5pbWF0aW9ucy5cbi8vIHdlIGNhbiBjaGFpbiBtYW55IGFuaW1hdGlvbnMgYmFzZWQgb24gdmFsdWVzIGZyb20gYSBsaXN0LCBieSByZWR1Y2luZyBvdmVyIHRoZSBzdGFydCBvZiB0aGUgYW5pbWF0aW9uIGNoYWluLiAgICAgICAgXG5hbmltYXRvci5wbGF5KFxuICAgIEF4LmNyZWF0ZSgpXG4vLy50cmFuc2xhdGUoWzUwLCA1MF0pICBCVUcgVEhJUyBET0VTTidUIFdPUksgSEVSRT8gICAgXG4gICAgLmJlZ2luUGF0aCgpXG4gICAgLnBsYXlBbGwoXG4gICAgICAgIHRpbWVWYXJ5aW5nUG9pbnRMaXN0Lm1hcFZhbHVlKCAvLyB0aW1lIHZhcnlpbmcgcG9pbnQgc2V0IGlzIG1hcHBlZCB0byBhIHRpbWUgdmFyeWluZyBhbmltYXRpb24gZm9yIHNxdWVuY2luZyBlYWNoIGZyYW1lXG4gICAgICAgICAgICAocG9pbnRMaXN0OiBudW1iZXJbXVtdKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gQ29udmVydCB0aGUgbGlzdCBvZiBwb2ludHMgaW50byBhIHNpbmdsZSBhbmltYXRpb24gY2hhaW5cbiAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnRMaXN0LnJlZHVjZSgoYW5pbWF0aW9uLCBwb2ludDogbnVtYmVyW10sIGluZGV4Om51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXggPT0gMCA/IGFuaW1hdGlvbi5tb3ZlVG8ocG9pbnQpOiBhbmltYXRpb24ubGluZVRvKHBvaW50KVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgb2YgY2hhaW4sIGJsYW5rIGFuaW1hdGlvbiB3aXRoIHRha2UoMSlcbiAgICAgICAgICAgICAgICAvLyB0aGUgdGFrZSgxKSBlbnN1cmUgdGhlIHBsYXllZCBhbmltYXRpb24gbGFzdHMgMSBmcmFtZVxuICAgICAgICAgICAgICAgIEF4LmNyZWF0ZSgpLnRyYW5zbGF0ZShbNTAsIDUwXSkudGFrZSgxKSk7IFxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgKVxuICAgIC5zdHJva2VTdHlsZShcImdyZWVuXCIpXG4gICAgLmxpbmVXaWR0aCgzKVxuICAgIC5zdHJva2UoKVxuKTtcblxuaGVscGVyLnBsYXlFeGFtcGxlKFwibGlzc2Fqb3VzXCIsIDY0LCBhbmltYXRvciwgMTAwLCAxMDApO1xuXG5cbmRlc2NyaWJlKCdsaXNzYWpvdXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQgKCdzaG91bGQgbWF0Y2ggdGhlIHJlZmVyZW5jZScsIGZ1bmN0aW9uKGRvbmUpIHtcbiAgICAgICAgaGVscGVyLnNhbWVFeGFtcGxlKFwibGlzc2Fqb3VzXCIsIFwibGlzc2Fqb3VzLXJlZlwiLCBmdW5jdGlvbihlcXVhbCkge1xuICAgICAgICAgICAgZXF1YWwuc2hvdWxkLmVxdWFsKHRydWUpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9KVxuICAgIH0pO1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
